{% extends "base.html"%}
{%block title%} {%endblock%}

{%block style%} 
    <style>
      .reply_comment{
          display: none;
      }
    </style>
{% endblock %}


    {%block jquery%} 
        <script>
          $(document).ready(function(){
            function update_iframe_size(){
                $("iframe").css("width","100%");
                $("iframe").css("height","500px");
         
                var parent_width =  $("#main_video iframe").parent().width() * 0.95;
                                    
                var parent_class =  $("#main_video iframe").parent().attr("class");
                              
                
                var width = $('#main_video iframe').css("width");
                var height = $('#main_video iframe').css("height");
                var ratio = parseInt(height)/parseInt(width);
                var new_height = parseInt(parent_width)* ratio;
                $("iframe").css("#main_video width",parent_width);
                $("iframe").css("#main_video height", new_height);
                
            }
            update_iframe_size();
            
            $(window).bind("resize",function(){
                update_iframe_size();
            })
            
            $('.reply_btn').click(function(e){
                e.preventDefault();
                $(this).next(".reply_comment").fadeToggle();
            });
          });
        </script>
    {% endblock %}



{% block content%}
<div class="row">
    <div class='col-sm-10 col-offset-2' id='main_video'>
        {{ object.embed_code | safe }}
    </div>
    
    <br />
    <a href="https://twitter.com/home?status= {{object.get_share_message | safe}}"><i class="fa fa-twitter" aria-hidden="true"></i>

Share on Twitter
</a>
</div>
<br/>
<hr/>
<div class="row">
    <div class='col-sm-12'>
        <form method="POST" action=".">{% csrf_token%}
            {{comment_form.as_p}} 
            <input value="add comment" type="submit">
        </form>
        
            
        <table class="table">
        
            {% for comment in comments %}
                
                   
                
               {%if not comment.is_child%}
              
               <tr><td>{{comment.text}} <small>via {{comment.user.username}} | {{comment.timestamp|timesince }}</small>
                                                 
                                        <ul>
                                            {% for child in comment.get_children%}
                                                <li>{{child.text}} <small>via {{child.user}}</small></li>
                                                 
                                            {% endfor %}
                                             
                                        </ul>
                                        <br/> <a href="#" class="reply_btn">Reply</a> | <a href="{{comment.get_absolute_url}}" class="">View Thread</a>
                                        <div class='reply_comment'>
                                                        <form method="POST" action="">{% csrf_token%}
                                                            {{comment_form.as_p}} 
                                                            <input type='hidden' name="parent_id" value="{{comment.id}}">
                                                            <input class="btn btn-default" value="add comment" type="submit">
                                                        </form>
                                                    </div>
                                        
                                   
                </td></tr>
                {% endif %}
            {% endfor %}
        </table>
    </div>
    <div>
</div>
   
{% endblock%}